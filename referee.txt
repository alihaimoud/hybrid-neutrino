==PLOTS:
pks_nu_ckrel2-0_6667.pdf
pks_nu_ckrel2-0_8333.pdf

> I have a list of comments that authors should address before I can recommend this paper for publication.
> 1.	The affiliation of the third author is not in the standard format.

Fixed.

> 2.	Is there any reason why authors cite the tight constraints from the Lya-forest and not cite the comparable ones from galaxy clustering: e.g. Vagnozzi et al. 2017?

We have added a citation to Vagnozzi et al.

> 3.	Authors cite a paper by Abazajian et al. 2015 to claim that the minimum neutrino mass can be constrained with LSST and DESI. Authors should cite more recent papers that carry out more realistic and accurate forecasts.

We have cited forecast papers for DESI, LSST and EUCLID, which give more exact numbers. Please let us know if we have missed further papers.

> 4.	Authors cite Abazajian et al. 2016 for future constraints from CMB. Can the authors cite more recent CMB S4 forecasts that account for realistic values of tau?

Could the referee please clarify? We understand that Abazajian 2016 (the CMB-S4 science book) uses the Planck 2015 optical depth measurement, which we believe to be the current best constraint. We have clarified the sentence, which may resolve the issue.

> 5.	Authors write that Banerjee et al. 2018 pointed out that neutrino shot-noise can be considerably reduced by densely sampling the full neutrino velocity distribution at each grid point. The reason why that method works is not only due a dense sampling of the Fermi-Dirac distribution. Please correct it.

We have amended the sentence and modified that paragraph. We note also that one way they suppress the effect of shot noise is to disable the short-range force for z>9, which will work well even for standard particle neutrinos.

> 6.	I am very surprised that authors do not cite the hybrid method of Brandbyge & Hannestad 2010 in the introduction and they only add it in a footnote, as that method is very similar to the one of the authors. Please cite in the introduction that work and compare it with the method developed by the authors, showing the advantages/disadvantages of using each.

This was certainly an oversight! We have added a detailed discussion of B&H 2010 making explicit the differences between them, and where we feel our new method improves upon it.

> 7.	Authors do not discuss all the different methods to implement neutrinos. For instance, Dakin et al 2018 (1712.03944), introduced a new a very efficient method. Please cite that method in the introduction and compare it with the one by the authors.

We have added a citation and discussion of Dakin 2018 in the introduction.

> 8.	In footnote 8 authors write that they compute the matter power spectrum by adding the CDM power spectrum to the neutrino power spectrum. What do they do with the CDM-NU cross-power spectrum?

Note that we assume in our LRA that the neutrinos are completely correlated with the CDM.

> 9.	Authors write that they have implemented a number of optimizations in the tree build code. Please state them.

We have added a brief description of the optimizations implemented.

> 10.	How many neutrino particles contain the PARTICLE-MINNU simulation? 512^3 in total of 512^3 for 0.05eV and 512^3 for 0.009eV?

512^3 in total for 0.05 eV; particles are not included for the 0.009 eV mass state. We have clarified this.

> 11.	Authors say that a particle simulation with 512^3 neutrino particles showed a deviation of ~1% from linear theory. Please show in a plot the matter power spectrum from the two simulations to support your claim. From Fig. 12 I can see that at the level of the neutrino Pk, that should be much severely affected by shot-noise (even after subtracting it), the agreement between the PARTICLE and PARTICLE-1024 simulations is excellent (better than the agreement between the PARTICLE and HYBRYD simulations).

We have added the PARTICLE simulation to Figure 6. Notice that the offset in the total power is similar to the offset in the neutrino power. It indeed appears initially a little odd that they are similar, since the neutrino power is a small fraction of the total matter power, but we believe this is because the effect on the total matter power increases over time, and the change in the neutrino power spectrum is much larger for z >> 1.

> 12.	Authors show in Fig. 5 how the clustering of neutrinos in the hybrid method is larger than in the particle method. However, the neutrino power spectrum from Fig. 10 is basically the same among methods. Can authors explain this?

Figure 10 shows the total neutrino power spectrum, while Figure 5 shows only the clustering of the neutrinos with v < 850 km/s, which is naturally larger. We have modified the caption to Figure 5 to make this clearer.

> 13.	Authors write that they find O(1%) differences with respect to CAMB at k<0.2 h/Mpc. I can see differences of that order on very linear scales, 0.04-0.05 h/Mpc, that are not expected and authors should justify.

These scales are close enough to the size of the box that there are very few modes available, which induces a scatter. We have added a sentence clarifying this point.

> 14.	Fig. 7. It seems to me that the agreement with linear theory is better for the particle simulation than for the linear response simulation. Authors should comment on this and find an explanation. Can you plot the CDM-NU cross-power spectrum for these two simulations and the comparison with linear theory? I think the CDM-NU cross-power spectrum will be much more sensible to any numerical source of error than the total matter Pk, that is dominated by CDM.

The apparent better agreement of the particle simulation is due to non-linear growth on large scales. To make this clear, we have added the z=0.5 plot, which shows that the particle simulation is lower than CAMB for k = 0.05 - k = 0.15, while the LINRESP simulation agrees.

> 15.	I find Fig. 7 very worrisome as it does not exhibit the classic spoon-shape. Works using similar neutrino masses and with different hierarchies have found that feature, e.g. 1203.5342, or 1711.10524, so authors should understand why it does not show up in their simulations.

This is, we think, a fluke of our limited resolution and our particular realisation. The spoon shape is present at z=0.2 and z=0.5 (see the new figure), and is simply suppressed at z=0, probably by a chance coincidence with the formation of a large halo.

> 16.	I am also concerned about Fig. 9, where authors show that the cross-correlation coefficient between fast neutrinos and CDM is not 1 on k<0.06 h/Mpc, but slightly lower (~0.985-0.99). A 1% change on such large scales can have a non-negligible impact that authors should address.

It is unity for the hybrid particles, and becomes sub-unity only for the fastest particles in the PARTICLE simulation (ie, exactly those for which shot noise is likely to be most important). We regard this as an unphysical numerical problem with purely particle simulations, and have added a note to that effect.

> 17.	Can authors plot the cross-correlation coefficient between fast and slow neutrinos to justify the way they compute the neutrino power spectrum in hybrid simulations (they assume they are completely correlated on all scales).

Note that in the LRA we assume that fast neutrinos are completely correlated with the CDM. So the requested plot would be the same as Figure 9. As explained in 5.3.2 at k > 0.5 h/Mpc, the first scale where the neutrinos are decorrelated with the CDM, the slow neutrinos strongly dominate the power, so that the cross-correlation between fast and slow neutrinos is irrelevant.

> 18.	In Figs. 10 and 11 there is a sudden drop of power at k~0.15 h/Mpc. Do authors know the reason for it? That feature seems to appear in both the hybrid and linear response method and not in the particle method and is clearly not physical.

==TODO==

> 19.	Authors reach the conclusion that the dip at k~1 h/Mpc is due to shot-noise from fast moving neutrinos. While they justify it with the results of the HYBRID-v5000 simulation, I find hard to believe that shot-noise from fast neutrinos can produce such sharp feature. Can authors show the results of that figure at z=0.5?

We do not regard this feature as especially sharp, as the total amplitude is only a few percent. We think it comes from the transition from shot-noise-dominated to structure-dominated. We attach the plot at z=0.5 and z=0.2; the feature is still present, at the same scale, but somewhat smaller. We found that shot noise interacted with our tree code in complex non-linear ways.

> 20.	Fig. 12. Please add the linear theory prediction by CAMB or CLASS.

We have done so. Neither the particle nor the hybrid methods agree particularly well with CAMB (although LINRESP does) - some of this may be a small amount of non-linear growth present even on large scales, but most likely it is numerical integration error. 5% convergence was about the best we could do for the neutrino power spectrum, and we consider it acceptable for a quantity which is such a small fraction of the total matter density.

> 21.	Authors say that their method allow them to make zoom-in simulations. Are authors sure about this? Even for velocities of ~800 km/s neutrinos can travel a rather large distance that I think cannot be fully accounted for in zoom-in simulations.

We're not completely sure (we haven't tried yet), but our intention was to perform zoom simulations of Milky Way size halos, which would only need particles to follow neutrinos of < 200 km/s. These particles have travelled about O(1 Mpc) since z=1, which should be possible to perform a zoom on. For a zoom simulation we also would not need percent level accuracy.

> 22.	Authors should discuss why they choose to follow slow neutrino tracers already from the initial conditions while the approach employed by Brandbyge & Hannestad did not. I notice that in the latter, since neutrinos are introduced at later times, the slow neutrinos are not affected by shot-noise. I find this the largest disadvantage of the hybrid method presented here.

We have now discussed this in the introduction, and in the first paragraph of section 3.2. We did attempt introducing particles dynamically at later times initially, but we found this less accurate, because the split is in the unperturbed velocity (notice that B&H 2010 use a different splitting criterion), and because computing the phase of the newly introduced neutrinos was non-trivial. We also found that it significantly increased the implementation complexity.
